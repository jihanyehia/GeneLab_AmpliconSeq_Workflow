FROM mambaorg/micromamba:2.0-ubuntu22.04

LABEL AUTHOR="Olabiyi Obayomi"
LABEL EMAIL="obadbotanist@yahoo.com"

COPY --chown=$MAMBA_USER:$MAMBA_USER diversity.yaml /tmp/diversity.yaml
RUN micromamba create -y -f /tmp/diversity.yaml && \
    micromamba clean --all --yes

RUN echo "eval $(micromamba shell hook --shell bash) && micromamba activate && micromamba activate /opt/conda/envs/R_diversity/" > ~/.bashrc

ENV PATH="/opt/conda/envs/R_diversity/bin/:/opt/conda/bin:$PATH"

CMD ["/bin/bash"]